<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Shh — Messaggi</title>
<style>
:root{--bg:#0f172a;--card:#0b1220;--accent:#9ca3ff}
html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial}
body{display:grid;place-items:center;background:linear-gradient(180deg,#071032,#0f172a);color:#e6eef8}
.card{width:min(92vw,720px);padding:3rem;border-radius:18px;background:rgba(255,255,255,0.03);box-shadow:0 8px 30px rgba(2,6,23,0.6);text-align:center;position:relative}
#carousel{overflow:hidden;}
.slide{min-width:100%;transition:transform 0.4s ease;font-size:clamp(20px,6vw,48px);line-height:1.1;margin-bottom:1rem}
.slide-date{font-size:0.9rem;opacity:0.7;margin-bottom:1.5rem}
#slides{display:flex;}
.nav{margin-top:1.5rem;display:flex;justify-content:center;align-items:center;gap:1rem}
.nav-btn{cursor:pointer;background:rgba(255,255,255,0.08);border:1px solid #9ca3ff;padding:0.6rem 1rem;border-radius:10px;color:#e6eef8;font-size:1rem;min-width:55px}
.nav-icon{font-size:1.4rem;opacity:0.8}
.hint{margin-top:1rem;font-size:0.85rem;color:var(--accent)}
footer{margin-top:1.5rem;font-size:0.85rem;opacity:0.7}
</style>
</head>
<body>
<div style="position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; border:10px solid #9ca3ff; box-sizing:border-box; border-radius:20px; z-index:9999;"></div>


<main class="card">
<div id="carousel">
<div id="slides"></div>
</div>


<div class="nav">
<button class="nav-btn" id="prevBtn">◀</button>
<div class="nav-icon">✦</div>
<button class="nav-btn" id="nextBtn">▶</button>
</div>


<div class="hint">Scorri tra i messaggi ✌️</div>
<footer>Carica <code>message1.txt, message2.txt...</code> su GitHub.</footer>
</main>


<script>
async function loadMessages(){
const slides = document.getElementById('slides');
let index = 1;
let found = true;
const msgs = [];


while(found){
try{
const res = await fetch(`message${index}.txt`, {cache:'no-store'});
if(!res.ok){ found = false; break; }
const text = (await res.text()).trim();
const lm = res.headers.get('last-modified');
msgs.push({text, lm});
index++;
}catch(e){ found = false; }
}


if(msgs.length === 0){
slides.innerHTML = '<div class="slide">Nessun messaggio trovato</div>';
return;
}


msgs.forEach(m => {
const wrapper = document.createElement('div');
wrapper.style.minWidth = '100%';
wrapper.style.textAlign = 'center';
wrapper.style.padding = '0 1rem';


const div = document.createElement('div');
div.className = 'slide';
div.textContent = m.text;


const dateDiv = document.createElement('div');
dateDiv.className = 'slide-date';
if(m.lm){
const d = new Date(m.lm);
if(!isNaN(d)) dateDiv.textContent = 'Pubblicato: ' + d.toLocaleString();
}


wrapper.appendChild(div);
wrapper.appendChild(dateDiv);
slides.appendChild(wrapper);
});


return msgs.length;
}


let current = 0;
function updateCarousel(){
const slides = document.getElementById('slides');
slides.style.transform = `translateX(${-current*100}%)`;
}


document.getElementById('prevBtn').onclick = () => {
current = Math.max(0, current-1);
updateCarousel();
};
document.getElementById('nextBtn').onclick = () => {
current = Math.min(totalSlides-1, current+1);
updateCarousel();
};


let totalSlides = 0;
loadMessages().then(n => { totalSlides = n; updateCarousel(); });
</script>
</body>
</html>
